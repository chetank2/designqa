services:
  - type: web
    name: designqa
    env: docker
    plan: free
    region: oregon
    dockerfilePath: apps/saas-backend/Dockerfile
    dockerContext: .
    autoDeploy: true
    healthCheckPath: /api/health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PUPPETEER_SKIP_CHROMIUM_DOWNLOAD
        value: "true"
      # Server binding - must be 0.0.0.0 for Render to detect the port
      - key: SERVER_HOST
        value: "0.0.0.0"
      # MCP Configuration - disable local MCP and use Remote MCP
      - key: ENABLE_LOCAL_MCP
        value: "false"
      - key: FIGMA_CONNECTION_MODE
        value: "figma"
      - key: FIGMA_MCP_URL
        value: "https://mcp.figma.com/mcp"
      # Required secrets (set in Render dashboard)
      - key: FIGMA_API_KEY
        sync: false
      - key: VITE_SUPABASE_URL
        sync: false
      - key: VITE_SUPABASE_ANON_KEY
        sync: false

  - type: web
    name: mcp-proxy
    env: node
    region: oregon
    rootDir: mcp-proxy
    buildCommand: "npm install && npm run build"
    startCommand: "npm run start"
    plan: free
    envVars:
      - key: FIGMA_MCP_URL
        value: wss://mcp.figma.com/transports/websocket
      - key: FIGMA_CLIENT_ID
        sync: false
      - key: FIGMA_CLIENT_SECRET
        sync: false
      - key: FIGMA_PAT
        sync: false
